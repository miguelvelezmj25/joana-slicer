<html><body style="font-size:16px;width:1000px;"><pre><code><div> /*</div><div>  *  Copyright 2016 Patrick Favre-Bulle</div><div>  *</div><div>  *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</div><div>  *  you may not use this file except in compliance with the License.</div><div>  *  You may obtain a copy of the License at</div><div>  *</div><div>  *      http://www.apache.org/licenses/LICENSE-2.0</div><div>  *</div><div>  * Unless required by applicable law or agreed to in writing, software</div><div>  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</div><div>  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</div><div>  * See the License for the specific language governing permissions and</div><div>  * limitations under the License.</div><div>  */</div><div> </div><div> package at.favre.tools.dconvert.util;</div><div> </div><div> import java.io.File;</div><div> import java.io.PrintWriter;</div><div> import java.io.StringWriter;</div><div> import java.util.Arrays;</div><div> import java.util.HashSet;</div><div> import java.util.Locale;</div><div> import java.util.Set;</div><div> </div><div> /** Misc util methods */</div><div> public final class MiscUtil {</div><div>   private MiscUtil() {}</div><div> </div><div>   public static String getStackTrace(Throwable t) {</div><div style="background-color:MediumSpringGreen;">     StringWriter sw = new StringWriter();</div><div style="background-color:MediumSpringGreen;">     PrintWriter pw = new PrintWriter(sw);</div><div style="background-color:MediumSpringGreen;">     t.printStackTrace(pw);</div><div style="background-color:MediumSpringGreen;">     return sw.toString();</div><div>   }</div><div> </div><div>   public static String duration(long ms) {</div><div>     if (ms &gt;= 1000) {</div><div>       return String.format(Locale.US, &quot;%.2f sec&quot;, (double) ms / 1000);</div><div>     }</div><div>     return ms + &quot; ms&quot;;</div><div>   }</div><div> </div><div>   public static &lt;T&gt; T[] concat(T[] first, T[] second) {</div><div style="background-color:MediumSpringGreen;">     T[] result = Arrays.copyOf(first, first.length + second.length);</div><div style="background-color:MediumSpringGreen;">     System.arraycopy(second, 0, result, first.length, second.length);</div><div style="background-color:MediumSpringGreen;">     return result;</div><div>   }</div><div> </div><div>   public static File createAndCheckFolder(String path, boolean dryRun) {</div><div style="background-color:MediumSpringGreen;">     File f = new File(path);</div><div> </div><div style="background-color:MediumSpringGreen;">     if (dryRun) {</div><div style="background-color:MediumSpringGreen;">       return f;</div><div>     }</div><div> </div><div style="background-color:MediumSpringGreen;">     if (!f.exists()) {</div><div style="background-color:MediumSpringGreen;">       f.mkdirs();</div><div>     }</div><div> </div><div style="background-color:MediumSpringGreen;">     if (!f.exists() || !f.isDirectory()) {</div><div>       throw new IllegalStateException(&quot;could not create folder: &quot; + path);</div><div>     }</div><div style="background-color:MediumSpringGreen;">     return f;</div><div>   }</div><div> </div><div>   public static String getFileExtensionLowerCase(File file) {</div><div style="background-color:MediumSpringGreen;">     return getFileExtension(file).toLowerCase();</div><div>   }</div><div> </div><div>   public static String getFileExtension(File file) {</div><div style="background-color:MediumSpringGreen;">     if (file == null) {</div><div style="background-color:MediumSpringGreen;">       return &quot;&quot;;</div><div>     }</div><div style="background-color:MediumSpringGreen;">     return file.getName().substring(file.getName().lastIndexOf(&quot;.&quot;) + 1);</div><div>   }</div><div> </div><div>   public static String getFileNameWithoutExtension(File file) {</div><div style="background-color:MediumSpringGreen;">     String fileName = file.getName();</div><div style="background-color:MediumSpringGreen;">     int pos = fileName.lastIndexOf(&quot;.&quot;);</div><div style="background-color:MediumSpringGreen;">     if (pos &gt; 0) {</div><div style="background-color:MediumSpringGreen;">       fileName = fileName.substring(0, pos);</div><div>     }</div><div style="background-color:MediumSpringGreen;">     return fileName;</div><div>   }</div><div> </div><div>   public static String getCmdProgressBar(float progress) {</div><div>     int loadingBarCount = 40;</div><div style="background-color:MediumSpringGreen;">     int bars = Math.round((float) loadingBarCount * progress);</div><div style="background-color:MediumSpringGreen;">     StringBuilder sb = new StringBuilder(&quot;\r[&quot;);</div><div> </div><div style="background-color:MediumSpringGreen;">     for (int i = 0; i &lt; loadingBarCount; i++) {</div><div style="background-color:MediumSpringGreen;">       if (i &lt; bars) {</div><div style="background-color:MediumSpringGreen;">         sb.append(&quot;-&quot;);</div><div>       } else {</div><div style="background-color:MediumSpringGreen;">         sb.append(&quot; &quot;);</div><div>       }</div><div>     }</div><div style="background-color:MediumSpringGreen;">     sb.append(&quot;] &quot;);</div><div> </div><div style="background-color:MediumSpringGreen;">     if (progress &lt; 1f) {</div><div style="background-color:MediumSpringGreen;">       sb.append(String.format(&quot;%6s&quot;, String.format(Locale.US, &quot;%.2f&quot;, progress * 100f)))</div><div style="background-color:MediumSpringGreen;">           .append(&quot;%&quot;);</div><div>     } else {</div><div style="background-color:MediumSpringGreen;">       sb.append(&quot;100.00%\n&quot;);</div><div>     }</div><div> </div><div style="background-color:MediumSpringGreen;">     return sb.toString();</div><div>   }</div><div> </div><div>   public static &lt;T&gt; Set&lt;T&gt; toSet(T elem) {</div><div>     Set&lt;T&gt; set = new HashSet&lt;T&gt;(1);</div><div>     set.add(elem);</div><div>     return set;</div><div>   }</div><div> </div><div>   public static void deleteFolder(File folder) {</div><div style="background-color:MediumSpringGreen;">     if (folder != null &amp;&amp; folder.exists()) {</div><div style="background-color:MediumSpringGreen;">       File[] files = folder.listFiles();</div><div style="background-color:MediumSpringGreen;">       if (files != null) { // some JVMs return null for empty dirs</div><div style="background-color:MediumSpringGreen;">         for (File f : files) {</div><div style="background-color:MediumSpringGreen;">           if (f.isDirectory()) {</div><div style="background-color:MediumSpringGreen;">             deleteFolder(f);</div><div>           } else {</div><div>             f.delete();</div><div>           }</div><div>         }</div><div>       }</div><div>       folder.delete();</div><div>     }</div><div>   }</div><div> }</div></code></pre></body></html>