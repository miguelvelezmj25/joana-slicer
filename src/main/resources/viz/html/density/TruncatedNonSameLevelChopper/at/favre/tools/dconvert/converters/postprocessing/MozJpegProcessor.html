<html><body style="font-size:16px;width:1000px;"><pre><code><div> /*</div><div>  *  Copyright 2016 Patrick Favre-Bulle</div><div>  *</div><div>  *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</div><div>  *  you may not use this file except in compliance with the License.</div><div>  *  You may obtain a copy of the License at</div><div>  *</div><div>  *      http://www.apache.org/licenses/LICENSE-2.0</div><div>  *</div><div>  * Unless required by applicable law or agreed to in writing, software</div><div>  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</div><div>  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</div><div>  * See the License for the specific language governing permissions and</div><div>  * limitations under the License.</div><div>  */</div><div> </div><div> package at.favre.tools.dconvert.converters.postprocessing;</div><div> </div><div> import at.favre.tools.dconvert.arg.ImageType;</div><div> import at.favre.tools.dconvert.converters.Result;</div><div> import at.favre.tools.dconvert.util.PostProcessorUtil;</div><div> </div><div> import java.io.File;</div><div> import java.util.Collections;</div><div> </div><div> /** Optimzes jpeg with mozjpeg https://github.com/mozilla/mozjpeg */</div><div> public class MozJpegProcessor extends APostProcessor {</div><div>   @Override</div><div>   public Result synchronizedProcess(File rawFile, boolean keepOriginal) {</div><div>     try {</div><div>       String[] args =</div><div>           new String[] {</div><div>             &quot;jpegtran&quot;,</div><div>             &quot;-outfile&quot;,</div><div>             &quot;%%outFilePath%%&quot;,</div><div>             &quot;-optimise&quot;,</div><div>             &quot;-progressive&quot;,</div><div>             &quot;-copy&quot;,</div><div>             &quot;none&quot;,</div><div>             &quot;%%sourceFilePath%%&quot;</div><div>           };</div><div>       return PostProcessorUtil.runImageOptimizer(rawFile, ImageType.JPG, args, keepOriginal);</div><div>     } catch (Exception e) {</div><div>       return new Result(</div><div>           &quot;could not execute post processor &quot; + getClass().getSimpleName(),</div><div>           e,</div><div>           Collections.singletonList(rawFile));</div><div>     }</div><div>   }</div><div> </div><div>   @Override</div><div>   public boolean isSupported() {</div><div style="background-color:MediumSpringGreen;">     return PostProcessorUtil.canRunCmd(new String[] {&quot;jpegtran&quot;, &quot;-h&quot;});</div><div>   }</div><div> }</div></code></pre></body></html>