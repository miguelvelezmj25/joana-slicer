<html><body><pre><code><div>  /*</div><div>   *  Copyright 2016 Patrick Favre-Bulle</div><div>   *</div><div>   *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</div><div>   *  you may not use this file except in compliance with the License.</div><div>   *  You may obtain a copy of the License at</div><div>   *</div><div>   *      http://www.apache.org/licenses/LICENSE-2.0</div><div>   *</div><div>   * Unless required by applicable law or agreed to in writing, software</div><div>   * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</div><div>   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</div><div>   * See the License for the specific language governing permissions and</div><div>   * limitations under the License.</div><div>   */</div><div>  </div><div>  package at.favre.tools.dconvert.converters;</div><div>  </div><div>  import at.favre.tools.dconvert.arg.Arguments;</div><div>  import at.favre.tools.dconvert.arg.ImageType;</div><div>  import at.favre.tools.dconvert.converters.descriptors.AndroidDensityDescriptor;</div><div>  import at.favre.tools.dconvert.util.MiscUtil;</div><div>  </div><div>  import java.awt.*;</div><div>  import java.io.File;</div><div>  import java.util.ArrayList;</div><div>  import java.util.List;</div><div>  </div><div>  /** Converts and creates Android-style resource set */</div><div>* public class AndroidConverter extends APlatformConverter&lt;AndroidDensityDescriptor&gt; {</div><div>  </div><div>    private static final String ANDROID_FOLDER_NAME = &quot;android&quot;;</div><div>  </div><div>    public static List&lt;AndroidDensityDescriptor&gt; getAndroidDensityDescriptors(Arguments arguments) {</div><div>*     List&lt;AndroidDensityDescriptor&gt; list = new ArrayList&lt;AndroidDensityDescriptor&gt;();</div><div>*     String dirPrefix = arguments.createMipMapInsteadOfDrawableDir ? &quot;mipmap&quot; : &quot;drawable&quot;;</div><div>*     if (arguments.includeAndroidLdpiTvdpi) {</div><div>*       list.add(new AndroidDensityDescriptor(0.75f, &quot;ldpi&quot;, dirPrefix + &quot;-ldpi&quot;));</div><div>*       list.add(new AndroidDensityDescriptor(1.33f, &quot;tvdpi&quot;, dirPrefix + &quot;-tvdpi&quot;));</div><div>      }</div><div>*     list.add(new AndroidDensityDescriptor(1, &quot;mdpi&quot;, dirPrefix + &quot;-mdpi&quot;));</div><div>*     list.add(new AndroidDensityDescriptor(1.5f, &quot;hdpi&quot;, dirPrefix + &quot;-hdpi&quot;));</div><div>*     list.add(new AndroidDensityDescriptor(2, &quot;xhdpi&quot;, dirPrefix + &quot;-xhdpi&quot;));</div><div>*     list.add(new AndroidDensityDescriptor(3, &quot;xxhdpi&quot;, dirPrefix + &quot;-xxhdpi&quot;));</div><div>*     list.add(new AndroidDensityDescriptor(4, &quot;xxxhdpi&quot;, dirPrefix + &quot;-xxxhdpi&quot;));</div><div>*     return list;</div><div>    }</div><div>  </div><div>    public static boolean isNinePatch(File file) {</div><div>*     return file.getName().endsWith(&quot;.9.png&quot;);</div><div>    }</div><div>  </div><div>    @Override</div><div>    public List&lt;AndroidDensityDescriptor&gt; usedOutputDensities(Arguments arguments) {</div><div>*     return getAndroidDensityDescriptors(arguments);</div><div>    }</div><div>  </div><div>    @Override</div><div>    public AndroidDensityDescriptor originalOutputDensities() {</div><div>*     return new AndroidDensityDescriptor(1, &quot;odpi&quot;, &quot;drawable-xxxxhdpi&quot;);</div><div>    }</div><div>  </div><div>    @Override</div><div>    public String getConverterName() {</div><div>*     return &quot;android-converter&quot;;</div><div>    }</div><div>  </div><div>    @Override</div><div>    public File createMainSubFolder(</div><div>        File destinationFolder, String targetImageFileName, Arguments arguments) {</div><div>*     if (arguments.platform.size() &gt; 1) {</div><div>*       return MiscUtil.createAndCheckFolder(</div><div>*           new File(destinationFolder, ANDROID_FOLDER_NAME).getAbsolutePath(), arguments.dryRun);</div><div>      } else {</div><div>*       return destinationFolder;</div><div>      }</div><div>    }</div><div>  </div><div>    @Override</div><div>    public File createFolderForOutputFile(</div><div>        File mainSubFolder,</div><div>        AndroidDensityDescriptor density,</div><div>        Dimension dimension,</div><div>        String targetFileName,</div><div>        Arguments arguments) {</div><div>*     return MiscUtil.createAndCheckFolder(</div><div>*         new File(mainSubFolder, density.folderName).getAbsolutePath(), arguments.dryRun);</div><div>    }</div><div>  </div><div>    @Override</div><div>    public String createDestinationFileNameWithoutExtension(</div><div>        AndroidDensityDescriptor density,</div><div>        Dimension dimension,</div><div>        String targetFileName,</div><div>        Arguments arguments) {</div><div>*     return targetFileName;</div><div>    }</div><div>  </div><div>    @Override</div><div>    public void onPreExecute(</div><div>        File dstFolder,</div><div>        String targetFileName,</div><div>        List&lt;AndroidDensityDescriptor&gt; densityDescriptions,</div><div>        ImageType imageType,</div><div>        Arguments arguments)</div><div>        throws Exception {</div><div>      // nothing</div><div>    }</div><div>  </div><div>    @Override</div><div>    public void onPostExecute(Arguments arguments) {</div><div>      // nothing</div><div>    }</div><div>  </div><div>    @Override</div><div>    public void clean(Arguments arguments) {</div><div>*     if (arguments.platform.size() == 1) {</div><div>        for (AndroidDensityDescriptor androidDensityDescriptor :</div><div>*           getAndroidDensityDescriptors(arguments)) {</div><div>          File dir = new File(arguments.dst, androidDensityDescriptor.folderName);</div><div>          MiscUtil.deleteFolder(dir);</div><div>        }</div><div>        File dir = new File(arguments.dst, originalOutputDensities().folderName);</div><div>        MiscUtil.deleteFolder(dir);</div><div>      } else {</div><div>        MiscUtil.deleteFolder(new File(arguments.dst, ANDROID_FOLDER_NAME));</div><div>      }</div><div>    }</div><div>  }</div></code></pre></body></html>