<html><body style="font-size:16px;width:1000px;"><pre><code><div> /*</div><div>  *  Copyright 2016 Patrick Favre-Bulle</div><div>  *</div><div>  *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</div><div>  *  you may not use this file except in compliance with the License.</div><div>  *  You may obtain a copy of the License at</div><div>  *</div><div>  *      http://www.apache.org/licenses/LICENSE-2.0</div><div>  *</div><div>  * Unless required by applicable law or agreed to in writing, software</div><div>  * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</div><div>  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</div><div>  * See the License for the specific language governing permissions and</div><div>  * limitations under the License.</div><div>  */</div><div> </div><div> package at.favre.tools.dconvert.arg;</div><div> </div><div> import at.favre.tools.dconvert.exceptions.InvalidArgumentException;</div><div> import at.favre.tools.dconvert.util.MiscUtil;</div><div> </div><div> import java.io.File;</div><div> import java.io.Serializable;</div><div> import java.text.MessageFormat;</div><div> import java.util.*;</div><div> </div><div> /** Handles all the arguments that can be set in the dconvert */</div><div> public class Arguments implements Serializable {</div><div>   public static final float DEFAULT_SCALE = 3f;</div><div>   public static final float DEFAULT_COMPRESSION_QUALITY = 0.9f;</div><div>   //    public static final int DEFAULT_THREAD_COUNT = 4;</div><div>   public static final int DEFAULT_THREAD_COUNT = 1;</div><div>   //    public static final int MAX_THREAD_COUNT = 8;</div><div>   public static final int MAX_THREAD_COUNT = 1;</div><div>   public static final RoundingHandler.Strategy DEFAULT_ROUNDING_STRATEGY =</div><div>       RoundingHandler.Strategy.ROUND_HALF_UP;</div><div>   public static final Set&lt;EPlatform&gt; DEFAULT_PLATFORM =</div><div>       new HashSet&lt;EPlatform&gt;(Arrays.asList(EPlatform.ANDROID, EPlatform.IOS));</div><div>   public static final EOutputCompressionMode DEFAULT_OUT_COMPRESSION =</div><div>       EOutputCompressionMode.SAME_AS_INPUT_PREF_PNG;</div><div>   public static final EScaleMode DEFAULT_SCALE_TYPE = EScaleMode.FACTOR;</div><div>   public static final EScalingAlgorithm DEFAULT_UPSCALING_QUALITY = EScalingAlgorithm.LANCZOS3;</div><div>   public static final EScalingAlgorithm DEFAULT_DOWNSCALING_QUALITY = EScalingAlgorithm.LANCZOS3;</div><div>   public static final Arguments START_GUI =</div><div>       new Arguments(</div><div>           null, null, 0.27346f, null, null, null, null, null, 0.9362f, 996254, false, false, false,</div><div>           false, false, false, false, false, false, false, false, false, false, null, false, false);</div><div>   private static final long serialVersionUID = 7;</div><div>   public final File src;</div><div>   public final File dst;</div><div>   public final float scale;</div><div>   public final Set&lt;EPlatform&gt; platform;</div><div>   public final EOutputCompressionMode outputCompressionMode;</div><div>   public final EScaleMode scaleMode;</div><div>   public final EScalingAlgorithm downScalingAlgorithm;</div><div>   public final EScalingAlgorithm upScalingAlgorithm;</div><div>   public final float compressionQuality;</div><div>   public final int threadCount;</div><div>   public final boolean skipExistingFiles;</div><div>   public final boolean skipUpscaling;</div><div>   public final boolean verboseLog;</div><div>   public final boolean includeAndroidLdpiTvdpi;</div><div>   public final boolean haltOnError;</div><div>   public final boolean createMipMapInsteadOfDrawableDir;</div><div>   public final boolean enablePngCrush;</div><div>   public final boolean enableMozJpeg;</div><div>   public final boolean postConvertWebp;</div><div>   public final boolean enableAntiAliasing;</div><div>   public final boolean dryRun;</div><div>   public final boolean keepUnoptimizedFilesPostProcessor;</div><div>   public final RoundingHandler.Strategy roundingHandler;</div><div>   public final boolean iosCreateImagesetFolders;</div><div>   public final boolean guiAdvancedOptions;</div><div>   public final boolean clearDirBeforeConvert;</div><div>   public final transient List&lt;File&gt; filesToProcess;</div><div> </div><div>   public Arguments(</div><div>       File src,</div><div>       File dst,</div><div>       float scale,</div><div>       Set&lt;EPlatform&gt; platform,</div><div>       EOutputCompressionMode outputCompressionMode,</div><div>       EScaleMode scaleMode,</div><div>       EScalingAlgorithm downScalingAlgorithm,</div><div>       EScalingAlgorithm upScalingAlgorithm,</div><div>       float compressionQuality,</div><div>       int threadCount,</div><div>       boolean skipExistingFiles,</div><div>       boolean skipUpscaling,</div><div>       boolean verboseLog,</div><div>       boolean includeAndroidLdpiTvdpi,</div><div>       boolean haltOnError,</div><div>       boolean createMipMapInsteadOfDrawableDir,</div><div>       boolean iosCreateImagesetFolders,</div><div>       boolean enablePngCrush,</div><div>       boolean enableMozJpeg,</div><div>       boolean postConvertWebp,</div><div>       boolean enableAntiAliasing,</div><div>       boolean dryRun,</div><div>       boolean keepUnoptimizedFilesPostProcessor,</div><div>       RoundingHandler.Strategy roundingHandler,</div><div>       boolean guiAdvancedOptions,</div><div>       boolean clearDirBeforeConvert) {</div><div>     this.dst = dst;</div><div>     this.src = src;</div><div style="background-color:MediumSpringGreen;">     this.scale = scale;</div><div>     this.platform = platform;</div><div>     this.outputCompressionMode = outputCompressionMode;</div><div>     this.scaleMode = scaleMode;</div><div>     this.downScalingAlgorithm = downScalingAlgorithm;</div><div>     this.upScalingAlgorithm = upScalingAlgorithm;</div><div>     this.compressionQuality = compressionQuality;</div><div>     this.threadCount = threadCount;</div><div>     this.skipExistingFiles = skipExistingFiles;</div><div>     this.skipUpscaling = skipUpscaling;</div><div>     this.verboseLog = verboseLog;</div><div>     this.includeAndroidLdpiTvdpi = includeAndroidLdpiTvdpi;</div><div>     this.haltOnError = haltOnError;</div><div>     this.createMipMapInsteadOfDrawableDir = createMipMapInsteadOfDrawableDir;</div><div>     this.iosCreateImagesetFolders = iosCreateImagesetFolders;</div><div>     this.enablePngCrush = enablePngCrush;</div><div>     this.enableMozJpeg = enableMozJpeg;</div><div>     this.postConvertWebp = postConvertWebp;</div><div>     this.enableAntiAliasing = enableAntiAliasing;</div><div>     this.dryRun = dryRun;</div><div>     this.keepUnoptimizedFilesPostProcessor = keepUnoptimizedFilesPostProcessor;</div><div>     this.roundingHandler = roundingHandler;</div><div>     this.guiAdvancedOptions = guiAdvancedOptions;</div><div>     this.clearDirBeforeConvert = clearDirBeforeConvert;</div><div> </div><div>     this.filesToProcess = new ArrayList&lt;File&gt;();</div><div> </div><div>     Set&lt;String&gt; supportedFileTypes = getSupportedFileTypes();</div><div> </div><div>     if (src != null &amp;&amp; src.isDirectory()) {</div><div>       for (File file : src.listFiles()) {</div><div>         String extension = MiscUtil.getFileExtensionLowerCase(file);</div><div>         if (supportedFileTypes.contains(extension)) {</div><div>           filesToProcess.add(file);</div><div>         }</div><div>       }</div><div>     } else {</div><div>       if (supportedFileTypes.contains(MiscUtil.getFileExtensionLowerCase(src))) {</div><div>         filesToProcess.add(src);</div><div>       }</div><div>     }</div><div>   }</div><div> </div><div>   public Arguments() {</div><div>     this(</div><div>         null,</div><div>         null,</div><div>         DEFAULT_SCALE,</div><div>         DEFAULT_PLATFORM,</div><div>         DEFAULT_OUT_COMPRESSION,</div><div>         DEFAULT_SCALE_TYPE,</div><div>         DEFAULT_DOWNSCALING_QUALITY,</div><div>         DEFAULT_UPSCALING_QUALITY,</div><div>         DEFAULT_COMPRESSION_QUALITY,</div><div>         DEFAULT_THREAD_COUNT,</div><div>         false,</div><div>         false,</div><div>         true,</div><div>         false,</div><div>         false,</div><div>         false,</div><div>         false,</div><div>         false,</div><div>         false,</div><div>         false,</div><div>         false,</div><div>         false,</div><div>         false,</div><div>         DEFAULT_ROUNDING_STRATEGY,</div><div>         false,</div><div>         false);</div><div>   }</div><div> </div><div>   public static Set&lt;String&gt; getSupportedFileTypes() {</div><div>     Set&lt;String&gt; set = new HashSet&lt;String&gt;();</div><div>     for (ImageType imageType : ImageType.values()) {</div><div>       if (imageType.supportRead) {</div><div>         set.addAll(Arrays.asList(imageType.extensions));</div><div>       }</div><div>     }</div><div> </div><div>     return set;</div><div>   }</div><div> </div><div>   public static ImageType getImageType(File srcFile) {</div><div>     String extension = MiscUtil.getFileExtensionLowerCase(srcFile);</div><div>     if (extension.equals(&quot;jpg&quot;) || extension.equals(&quot;jpeg&quot;)) {</div><div>       return ImageType.JPG;</div><div>     }</div><div>     if (extension.equals(&quot;png&quot;)) {</div><div>       return ImageType.PNG;</div><div>     }</div><div>     if (extension.equals(&quot;svg&quot;)) {</div><div>       return ImageType.SVG;</div><div>     }</div><div>     if (extension.equals(&quot;tif&quot;) || extension.equals(&quot;tiff&quot;)) {</div><div>       return ImageType.TIFF;</div><div>     }</div><div>     if (extension.equals(&quot;psd&quot;)) {</div><div>       return ImageType.PSD;</div><div>     }</div><div>     if (extension.equals(&quot;gif&quot;)) {</div><div>       return ImageType.GIF;</div><div>     }</div><div>     if (extension.equals(&quot;bmp&quot;)) {</div><div>       return ImageType.BMP;</div><div>     }</div><div> </div><div>     throw new IllegalArgumentException(</div><div>         &quot;unknown file extension &quot; + extension + &quot; in srcFile &quot; + srcFile);</div><div>   }</div><div> </div><div>   public static List&lt;ImageType.ECompression&gt; getOutCompressionForType(</div><div>       EOutputCompressionMode type, ImageType imageType) {</div><div>     List&lt;ImageType.ECompression&gt; list = new ArrayList&lt;ImageType.ECompression&gt;(2);</div><div>     switch (type) {</div><div>       case AS_GIF:</div><div>         list.add(ImageType.ECompression.GIF);</div><div>         break;</div><div>       case AS_PNG:</div><div>         list.add(ImageType.ECompression.PNG);</div><div>         break;</div><div>       case AS_JPG:</div><div>         list.add(ImageType.ECompression.JPG);</div><div>         break;</div><div>       case AS_JPG_AND_PNG:</div><div>         list.add(ImageType.ECompression.JPG);</div><div>         list.add(ImageType.ECompression.PNG);</div><div>         break;</div><div>       case AS_BMP:</div><div>         list.add(ImageType.ECompression.BMP);</div><div>         break;</div><div>       case SAME_AS_INPUT_PREF_PNG:</div><div>         list.add(imageType.outCompressionCompat);</div><div>         break;</div><div>       default:</div><div>       case SAME_AS_INPUT_STRICT:</div><div>         list.add(imageType.outCompressionStrict);</div><div>         break;</div><div>     }</div><div>     return list;</div><div>   }</div><div> </div><div>   public double round(double raw) {</div><div style="background-color:MediumSpringGreen;">     return new RoundingHandler(roundingHandler).round(raw);</div><div>   }</div><div> </div><div> //  @Override</div><div> //  public String toString() {</div><div> //    return &quot;Arguments{&quot;</div><div> //        + &quot;src=&quot;</div><div> //        + src</div><div> //        + &quot;, dst=&quot;</div><div> //        + dst</div><div> //        + &quot;, scale=&quot;</div><div> //        + scale</div><div> //        + &quot;, platform=&quot;</div><div> //        + platform</div><div> //        + &quot;, outputCompressionMode=&quot;</div><div> //        + outputCompressionMode</div><div> //        + &quot;, scaleMode=&quot;</div><div> //        + scaleMode</div><div> //        + &quot;, downScalingAlgorithm=&quot;</div><div> //        + downScalingAlgorithm</div><div> //        + &quot;, upScalingAlgorithm=&quot;</div><div> //        + upScalingAlgorithm</div><div> //        + &quot;, compressionQuality=&quot;</div><div> //        + compressionQuality</div><div> //        + &quot;, threadCount=&quot;</div><div> //        + threadCount</div><div> //        + &quot;, skipExistingFiles=&quot;</div><div> //        + skipExistingFiles</div><div> //        + &quot;, skipUpscaling=&quot;</div><div> //        + skipUpscaling</div><div> //        + &quot;, verboseLog=&quot;</div><div> //        + verboseLog</div><div> //        + &quot;, includeAndroidLdpiTvdpi=&quot;</div><div> //        + includeAndroidLdpiTvdpi</div><div> //        + &quot;, haltOnError=&quot;</div><div> //        + haltOnError</div><div> //        + &quot;, createMipMapInsteadOfDrawableDir=&quot;</div><div> //        + createMipMapInsteadOfDrawableDir</div><div> //        + &quot;, enablePngCrush=&quot;</div><div> //        + enablePngCrush</div><div> //        + &quot;, enableMozJpeg=&quot;</div><div> //        + enableMozJpeg</div><div> //        + &quot;, postConvertWebp=&quot;</div><div> //        + postConvertWebp</div><div> //        + &quot;, enableAntiAliasing=&quot;</div><div> //        + enableAntiAliasing</div><div> //        + &quot;, dryRun=&quot;</div><div> //        + dryRun</div><div> //        + &quot;, keepUnoptimizedFilesPostProcessor=&quot;</div><div> //        + keepUnoptimizedFilesPostProcessor</div><div> //        + &quot;, roundingHandler=&quot;</div><div> //        + roundingHandler</div><div> //        + &quot;, iosCreateImagesetFolders=&quot;</div><div> //        + iosCreateImagesetFolders</div><div> //        + &quot;, guiAdvancedOptions=&quot;</div><div> //        + guiAdvancedOptions</div><div> //        + &quot;, clearDirBeforeConvert=&quot;</div><div> //        + clearDirBeforeConvert</div><div> //        + &quot;, filesToProcess=&quot;</div><div> //        + filesToProcess</div><div> //        + &#x27;}&#x27;;</div><div> //  }</div><div> </div><div> //  @Override</div><div> //  public boolean equals(Object o) {</div><div> //    if (this == o) return true;</div><div> //    if (o == null || getClass() != o.getClass()) return false;</div><div> //</div><div> //    Arguments arguments = (Arguments) o;</div><div> //</div><div> //    if (Float.compare(arguments.scale, scale) != 0) return false;</div><div> //    if (Float.compare(arguments.compressionQuality, compressionQuality) != 0) return false;</div><div> //    if (threadCount != arguments.threadCount) return false;</div><div> //    if (skipExistingFiles != arguments.skipExistingFiles) return false;</div><div> //    if (skipUpscaling != arguments.skipUpscaling) return false;</div><div> //    if (verboseLog != arguments.verboseLog) return false;</div><div> //    if (includeAndroidLdpiTvdpi != arguments.includeAndroidLdpiTvdpi) return false;</div><div> //    if (haltOnError != arguments.haltOnError) return false;</div><div> //    if (createMipMapInsteadOfDrawableDir != arguments.createMipMapInsteadOfDrawableDir)</div><div> //      return false;</div><div> //    if (enablePngCrush != arguments.enablePngCrush) return false;</div><div> //    if (enableMozJpeg != arguments.enableMozJpeg) return false;</div><div> //    if (postConvertWebp != arguments.postConvertWebp) return false;</div><div> //    if (enableAntiAliasing != arguments.enableAntiAliasing) return false;</div><div> //    if (dryRun != arguments.dryRun) return false;</div><div> //    if (keepUnoptimizedFilesPostProcessor != arguments.keepUnoptimizedFilesPostProcessor)</div><div> //      return false;</div><div> //    if (iosCreateImagesetFolders != arguments.iosCreateImagesetFolders) return false;</div><div> //    if (guiAdvancedOptions != arguments.guiAdvancedOptions) return false;</div><div> //    if (clearDirBeforeConvert != arguments.clearDirBeforeConvert) return false;</div><div> //    if (src != null ? !src.equals(arguments.src) : arguments.src != null) return false;</div><div> //    if (dst != null ? !dst.equals(arguments.dst) : arguments.dst != null) return false;</div><div> //    if (platform != null ? !platform.equals(arguments.platform) : arguments.platform != null)</div><div> //      return false;</div><div> //    if (outputCompressionMode != arguments.outputCompressionMode) return false;</div><div> //    if (scaleMode != arguments.scaleMode) return false;</div><div> //    if (downScalingAlgorithm != arguments.downScalingAlgorithm) return false;</div><div> //    if (upScalingAlgorithm != arguments.upScalingAlgorithm) return false;</div><div> //    if (roundingHandler != arguments.roundingHandler) return false;</div><div> //    return filesToProcess != null</div><div> //        ? filesToProcess.equals(arguments.filesToProcess)</div><div> //        : arguments.filesToProcess == null;</div><div> //  }</div><div> </div><div> //  @Override</div><div> //  public int hashCode() {</div><div> //    int result = src != null ? src.hashCode() : 0;</div><div> //    result = 31 * result + (dst != null ? dst.hashCode() : 0);</div><div> //    result = 31 * result + (scale != +0.0f ? Float.floatToIntBits(scale) : 0);</div><div> //    result = 31 * result + (platform != null ? platform.hashCode() : 0);</div><div> //    result = 31 * result + (outputCompressionMode != null ? outputCompressionMode.hashCode() : 0);</div><div> //    result = 31 * result + (scaleMode != null ? scaleMode.hashCode() : 0);</div><div> //    result = 31 * result + (downScalingAlgorithm != null ? downScalingAlgorithm.hashCode() : 0);</div><div> //    result = 31 * result + (upScalingAlgorithm != null ? upScalingAlgorithm.hashCode() : 0);</div><div> //    result =</div><div> //        31 * result + (compressionQuality != +0.0f ? Float.floatToIntBits(compressionQuality) : 0);</div><div> //    result = 31 * result + threadCount;</div><div> //    result = 31 * result + (skipExistingFiles ? 1 : 0);</div><div> //    result = 31 * result + (skipUpscaling ? 1 : 0);</div><div> //    result = 31 * result + (verboseLog ? 1 : 0);</div><div> //    result = 31 * result + (includeAndroidLdpiTvdpi ? 1 : 0);</div><div> //    result = 31 * result + (haltOnError ? 1 : 0);</div><div> //    result = 31 * result + (createMipMapInsteadOfDrawableDir ? 1 : 0);</div><div> //    result = 31 * result + (enablePngCrush ? 1 : 0);</div><div> //    result = 31 * result + (enableMozJpeg ? 1 : 0);</div><div> //    result = 31 * result + (postConvertWebp ? 1 : 0);</div><div> //    result = 31 * result + (enableAntiAliasing ? 1 : 0);</div><div> //    result = 31 * result + (dryRun ? 1 : 0);</div><div> //    result = 31 * result + (keepUnoptimizedFilesPostProcessor ? 1 : 0);</div><div> //    result = 31 * result + (roundingHandler != null ? roundingHandler.hashCode() : 0);</div><div> //    result = 31 * result + (iosCreateImagesetFolders ? 1 : 0);</div><div> //    result = 31 * result + (guiAdvancedOptions ? 1 : 0);</div><div> //    result = 31 * result + (clearDirBeforeConvert ? 1 : 0);</div><div> //    result = 31 * result + (filesToProcess != null ? filesToProcess.hashCode() : 0);</div><div> //    return result;</div><div> //  }</div><div> </div><div>   public static class Builder {</div><div>     private final float srcScale;</div><div>     private File dst;</div><div>     private File src = null;</div><div>     private EScaleMode scaleType = DEFAULT_SCALE_TYPE;</div><div>     private Set&lt;EPlatform&gt; platform = DEFAULT_PLATFORM;</div><div>     private EOutputCompressionMode outputCompressionMode = DEFAULT_OUT_COMPRESSION;</div><div>     private float compressionQuality = DEFAULT_COMPRESSION_QUALITY;</div><div>     private int threadCount = DEFAULT_THREAD_COUNT;</div><div>     private RoundingHandler.Strategy roundingStrategy = DEFAULT_ROUNDING_STRATEGY;</div><div>     private EScalingAlgorithm downScalingAlgorithm = DEFAULT_DOWNSCALING_QUALITY;</div><div>     private EScalingAlgorithm upScalingAlgorithm = DEFAULT_UPSCALING_QUALITY;</div><div>     private boolean skipExistingFiles = false;</div><div>     private boolean skipUpscaling = false;</div><div>     private boolean verboseLog = false;</div><div>     private boolean includeAndroidLdpiTvdpi = false;</div><div>     private boolean haltOnError = false;</div><div>     private boolean createMipMapInsteadOfDrawableDir = false;</div><div>     private boolean enableAntiAliasing = false;</div><div>     private boolean enablePngCrush = false;</div><div>     private boolean postConvertWebp = false;</div><div>     private boolean dryRun;</div><div>     private boolean enableMozJpeg;</div><div>     private boolean internalSkipParamValidation = false;</div><div>     private boolean keepUnoptimizedFilesPostProcessor;</div><div>     private boolean iosCreateImagesetFolders = false;</div><div>     private boolean guiAdvancedOptions;</div><div>     private boolean clearDirBeforeConvert;</div><div> </div><div>     public Builder(File src, float srcScale) {</div><div>       this.src = src;</div><div>       this.srcScale = srcScale;</div><div>     }</div><div> </div><div>     public Builder scaleMode(EScaleMode type) {</div><div>       this.scaleType = type;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder upScaleAlgorithm(EScalingAlgorithm scalingAlgorithm) {</div><div>       this.upScalingAlgorithm = scalingAlgorithm;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder downScaleAlgorithm(EScalingAlgorithm scalingAlgorithm) {</div><div>       this.downScalingAlgorithm = scalingAlgorithm;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder dstFolder(File dst) {</div><div>       this.dst = dst;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder platform(Set&lt;EPlatform&gt; platform) {</div><div>       this.platform = platform;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder compression(EOutputCompressionMode outputCompressionMode) {</div><div>       this.outputCompressionMode = outputCompressionMode;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder compression(</div><div>         EOutputCompressionMode outputCompressionMode, float compressionQuality) {</div><div>       this.outputCompressionMode = outputCompressionMode;</div><div>       this.compressionQuality = compressionQuality;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder threadCount(int threadCount) {</div><div>       this.threadCount = threadCount;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder skipExistingFiles(boolean b) {</div><div>       this.skipExistingFiles = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder skipUpscaling(boolean b) {</div><div>       this.skipUpscaling = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder verboseLog(boolean b) {</div><div>       this.verboseLog = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder includeAndroidLdpiTvdpi(boolean b) {</div><div>       this.includeAndroidLdpiTvdpi = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder haltOnError(boolean b) {</div><div>       this.haltOnError = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder createMipMapInsteadOfDrawableDir(boolean b) {</div><div>       this.createMipMapInsteadOfDrawableDir = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder antiAliasing(boolean b) {</div><div>       this.enableAntiAliasing = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder enablePngCrush(boolean b) {</div><div>       this.enablePngCrush = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder enableMozJpeg(boolean b) {</div><div>       this.enableMozJpeg = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder postConvertWebp(boolean b) {</div><div>       this.postConvertWebp = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder dryRun(boolean b) {</div><div>       this.dryRun = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder scaleRoundingStragy(RoundingHandler.Strategy strategy) {</div><div>       this.roundingStrategy = strategy;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder skipParamValidation(boolean b) {</div><div>       this.internalSkipParamValidation = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder keepUnoptimizedFilesPostProcessor(boolean b) {</div><div>       this.keepUnoptimizedFilesPostProcessor = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder iosCreateImagesetFolders(boolean b) {</div><div>       this.iosCreateImagesetFolders = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder guiAdvancedOptions(boolean b) {</div><div>       this.guiAdvancedOptions = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Builder clearDirBeforeConvert(boolean b) {</div><div>       this.clearDirBeforeConvert = b;</div><div>       return this;</div><div>     }</div><div> </div><div>     public Arguments build() throws InvalidArgumentException {</div><div>       if (!internalSkipParamValidation) {</div><div>         ResourceBundle bundle = ResourceBundle.getBundle(&quot;bundles.strings&quot;, Locale.getDefault());</div><div> </div><div>         if (platform.isEmpty()) {</div><div>           throw new InvalidArgumentException(bundle.getString(&quot;error.missing.platforms&quot;));</div><div>         }</div><div> </div><div>         if (src == null || !src.exists()) {</div><div>           throw new InvalidArgumentException(</div><div>               MessageFormat.format(bundle.getString(&quot;error.missing.src&quot;), src));</div><div>         }</div><div> </div><div>         if (dst == null) {</div><div>           if (src.isDirectory()) {</div><div>             dst = src;</div><div>           } else {</div><div>             dst = src.getParentFile();</div><div>           }</div><div>         }</div><div> </div><div>         if (compressionQuality &lt; 0 || compressionQuality &gt; 1.0) {</div><div>           throw new InvalidArgumentException(</div><div>               MessageFormat.format(</div><div>                   bundle.getString(&quot;error.invalid.compressionQ&quot;), compressionQuality));</div><div>         }</div><div> </div><div>         if (threadCount &lt; 1 || threadCount &gt; MAX_THREAD_COUNT) {</div><div>           throw new InvalidArgumentException(</div><div>               MessageFormat.format(</div><div>                   bundle.getString(&quot;error.invalid.thread&quot;), threadCount, MAX_THREAD_COUNT));</div><div>         }</div><div> </div><div>         switch (scaleType) {</div><div>           case FACTOR:</div><div>             if (srcScale &lt;= 0 || srcScale &gt;= 100) {</div><div>               throw new InvalidArgumentException(</div><div>                   MessageFormat.format(bundle.getString(&quot;error.invalid.factorscale&quot;), srcScale));</div><div>             }</div><div>             break;</div><div>           case DP_WIDTH:</div><div>           case DP_HEIGHT:</div><div>             if (srcScale &lt;= 0 || srcScale &gt;= 9999) {</div><div>               throw new InvalidArgumentException(</div><div>                   MessageFormat.format(bundle.getString(&quot;error.invalid.dp&quot;), srcScale));</div><div>             }</div><div>             break;</div><div>         }</div><div> </div><div>         if (downScalingAlgorithm == null || upScalingAlgorithm == null) {</div><div>           throw new InvalidArgumentException(bundle.getString(&quot;error.missing.scalealgorithm&quot;));</div><div>         }</div><div>       }</div><div>       return new Arguments(</div><div>           src,</div><div>           dst,</div><div>           srcScale,</div><div>           platform,</div><div>           outputCompressionMode,</div><div>           scaleType,</div><div>           downScalingAlgorithm,</div><div>           upScalingAlgorithm,</div><div>           compressionQuality,</div><div>           threadCount,</div><div>           skipExistingFiles,</div><div>           skipUpscaling,</div><div>           verboseLog,</div><div>           includeAndroidLdpiTvdpi,</div><div>           haltOnError,</div><div>           createMipMapInsteadOfDrawableDir,</div><div>           iosCreateImagesetFolders,</div><div>           enablePngCrush,</div><div>           enableMozJpeg,</div><div>           postConvertWebp,</div><div>           enableAntiAliasing,</div><div>           dryRun,</div><div>           keepUnoptimizedFilesPostProcessor,</div><div>           roundingStrategy,</div><div>           guiAdvancedOptions,</div><div>           clearDirBeforeConvert);</div><div>     }</div><div>   }</div><div> }</div></code></pre></body></html>